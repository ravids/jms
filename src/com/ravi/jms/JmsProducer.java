/*
 * File       : FixMsgSpout.java
 * Project    : NewArch
 * Company    : Citibank NA
 * Created on : Feb 15, 2017
 * Copyright  : Copyright (c) 2017 CITI - All Rights Reserved. 
 * This is UNPUBLISHED PROPRIETARY SOURCE CODE of CITI.
 * The copyright notice above does not evidence any actual or intended
 * publication of such source code. The contents of this file may not 
 * be disclosed to third parties, copied, or duplicated in any form, 
 * in whole or in part, without the prior written permission of CITI.
 */

package com.ravi.jms;





import org.apache.activemq.ActiveMQConnectionFactory;

import org.slf4j.LoggerFactory;





import java.util.ArrayList;
import java.util.Arrays;
import java.util.List;

import javax.jms.Connection;
import javax.jms.ConnectionFactory;
import javax.jms.DeliveryMode;
import javax.jms.Destination;

import javax.jms.MessageProducer;
import javax.jms.Session;
import javax.jms.TextMessage;



/**
 * Type : FixMsgSpout <BR>
 * Date : Feb 15, 2017 <BR>
 * Time : 12:26:01 AM <BR>
 * IDE : Eclipse <BR>
 * Description : TODO
 * 
 * @author :
 */
public final class JmsProducer {


	private transient Connection connection;
	private transient Session session;



	/**
	 * <code>ISpout</code> implementation.
	 * <p/>
	 * Connects the JMS spout to the configured JMS destination topic/queue.
	 * 
	 */
	@SuppressWarnings("rawtypes")
	public static void main(String args[]) {


		
		try {
			// Create a ConnectionFactory
		//	ConnectionFactory connectionFactory = new ActiveMQConnectionFactory("tcp://localhost:61616");
			ConnectionFactory connectionFactory = new ActiveMQConnectionFactory("tcp://vm-e22d-17f6.nam.nsroot.net:61616");
			

			// Create a Connection
			Connection connection = connectionFactory.createConnection();
			connection.start();


			// Create a Session
			Session session = connection.createSession(false, Session.AUTO_ACKNOWLEDGE);

			// Create the destination (Topic or Queue)
			Destination destination = session.createQueue("STORM.TEST");
			
	          // Create a MessageProducer from the Session to the Topic or Queue
            MessageProducer producer = session.createProducer(destination);
            producer.setDeliveryMode(DeliveryMode.PERSISTENT);
    	//	String msg1 = "8=FIX.4.4\u00019=1134\u000135=RIO\u000149=PTMS\u000150=PTSVR_RIO.4\u000152=20101028-18:23:18.000\u0001122=20101028-18:23:18.000\u0001627=1\u0001628=USPTE.OSM.7\u000110100=49376\u00011=AV2\u000154=1\u0001372=D\u00018004=?\u0001581=2\u0001529=5\u0001957=1\u0001958=IndexLmtBen\u0001959=14\u0001960=0.0\u000111=FAK\u00010011\u000110080=20101028-18:23:18.000\u000112=0.0\u0001150=A\u000110200=FAK\u00010011USPTE\u000110201=USPRGM\u000110202=USPROGRAM\u000110203=PRGMUS\u000110204=AEETT\u000110206=FAK\u00010011USPTE\u000110207=USPTE\u000110208=US.PTE.TRADER\u000110073=?;SRN;\u0001421=USA\u000110038=4613\u000115=USD\u0001845=44.48\u000110003=-1.0\u0001-1=FAK\u00010011\u0001100=TTNATACT\u000139=A\u000148=7816950\u0001167=CS\u0001202=44.48\u0001456=101\u000118=1\u000110006=;FCCUST;GO-240;|TransTime=20101028\u000114:23:49\u0001EDT|;\u0001126=20101029-00:00:00.000\u0001-17=gs93748\u0001151=0.0\u000110031=0A\u000166=!\u0001rags1\u000140=2\u0001528=A\u000137=1030149pi81\u000138=400000.0\u0001-5=1030149pi80\u000144=44.48\u0001-33=;E;\u000110042=Y\u000110036=4613\u0001455=7816950\u000122=101\u0001207=OTC\u000164=20101102\u000163=0\u000110045=?\u000110005=7\u000110015=IMAT\u000155=QCOM\u0001-14=-1\u000159=0\u000175=20101028\u000110039=DS08\u0001-27=\u0001377=N\u00015700=\u00015701=\u0001132=0.0\u000110030=OTC\u0001133=0.0\u0001-15=SO:PRGM;UI:gs93748;VN:IMATCH;\u000160=20101028-18:23:18.000\u000110075=0\u0001660=102\u000110007=20101028-18:23:18.000\u000110071=20101028-18:23:49.247\u0001100134=Y\u000110104=Y\u000110223=1\u000112052=1\u00016262=0.0\u000111210=1030149pi80\u000110292=501\u0001100232=501\u000111041=UNKNOWN_ENUM\u00016438=N\u000110184=1030149pi80\u0001284=501\u000110=000";
    		String msg1 = "8=FIX.4.4\u00019=1234\u000135=RIO\u000149=AEE\u000156=RIO\u000150=AEE1\u000157=C4_UK_DEV_T3\u000152=20120612-14:51:47.975\u0001122=20120612-14:51:47.973\u0001627=1\u0001628=UKLIQUIFI.OSM.1\u000110100=148674\u00011=TEST\u000154=2\u0001372=8\u00018001=CLIENT3\u00018004=SSG_IT2\u0001581=13\u000110018=12164050GbJK\u0001382=1\u0001375=LQUK\u000110053=LQPING\u000111=2757/2012-06-12-03:51\u0001150=F\u000110200=2757/2012-06-12-03:51UKLIQUIFI\u000110201=C4_LQPING\u000110202=EMEALP\u000110203=QFF\u000110204=LIQ\u000110206=2757/2012-06-12-03:51UKLIQUIFI\u000110207=UKLIQUIFI\u000110208=EMEA.LIQ\u0001548=P17623323028655001\u000114=1.0\u000110025=0\u000115=GBX\u0001-1=2757/2012-06-12-03:51\u0001100=LIQ\u000139=2\u000148=8113675\u0001167=CS\u000110076=CI\u000117=12164050GbJK\u000118=1\u000110017=LQUK\u000110021=AEE\u0001126=20120612-14:51:57.000\u000129=4\u0001-17=CLIENT3\u000110066=20120612-14:51:47.975\u000130=LQFI\u000131=2500.0\u000132=1.0\u0001151=0.0\u000140=1\u0001528=A\u000137=11164050JFDo\u000138=1.0\u000111015=20120612-14:51:47.972\u0001113=Y\u000122=101\u000110005=148\u000155=AZN.L\u0001-14=0\u000159=3\u000175=20120612\u000110039=sbxgran\u0001132=2500.0\u0001133=3100.0\u0001134=1000.0\u0001135=1000.0\u000160=20120612-14:51:47.975\u000110083=CLIENT3\u0001660=102\u0001847=1038\u000110071=20120612-14:51:47.985\u0001100134=Y\u000110104=Y\u000112052=3\u00018013=R\u00016=2500.0\u000110292=924\u000111041=17\u000110514=LQUK\u000110515=148\u00011133=D\u000111040=102\u000111210=12164050JFDo\u000110438=RIO.4.5\u000110533=1\u000110534=CGM\u000110535=5\u000110537=CGME\u0001100183=8001=CLIENT3:8015=CLIENT3:10005=6:8012=20120612\u00018012=20120612\u000110217=Y\u000110007=20120612-14:51:48.321\u000110000=20120612-14:51:47.973\u000110=000\u0001";
    		String msg2 = "8=FIX.4.4\u00019=1234\u000135=RIO\u000149=AEE\u000156=RIO\u000150=AEE1\u000157=C4_UK_DEV_T3\u000152=20120612-14:51:47.975\u0001122=20120612-14:51:47.973\u0001627=1\u0001628=UKLIQUIFI.OSM.1\u000110100=148674\u00011=TEST\u000154=2\u0001372=8\u00018001=CLIENT3\u00018004=SSG_IT2\u0001581=13\u000110018=12164050GbJK\u0001382=1\u0001375=LQUK\u000110053=LQPING\u000111=2757/2012-06-12-03:51\u0001150=F\u000110200=2757/2012-06-12-03:51UKLIQUIFI\u000110201=C4_LQPING\u000110202=EMEALP\u000110203=QFF\u000110204=LIQ\u000110206=2757/2012-06-12-03:51UKLIQUIFI\u000110207=UKLIQUIFI\u000110208=EMEA.LIQ\u0001548=P17623323028655001\u000114=1.0\u000110025=0\u000115=GBX\u0001-1=2757/2012-06-12-03:51\u0001100=LIQ\u000139=2\u000148=8113675\u0001167=CS\u000110076=CI\u000117=12164050GbJK\u000118=1\u000110017=LQUK\u000110021=AEE\u0001126=20120612-14:51:57.000\u000129=4\u0001-17=CLIENT3\u000110066=20120612-14:51:47.975\u000130=LQFI\u000131=2500.0\u000132=1.0\u0001151=0.0\u000140=1\u0001528=A\u000137=22264050JFDo\u000138=1.0\u000111015=20120612-14:51:47.972\u0001113=Y\u000122=101\u000110005=148\u000155=AZN.L\u0001-14=0\u000159=3\u000175=20120612\u000110039=sbxgran\u0001132=2500.0\u0001133=3100.0\u0001134=1000.0\u0001135=1000.0\u000160=20120612-14:51:47.975\u000110083=CLIENT3\u0001660=102\u0001847=1038\u000110071=20120612-14:51:47.985\u0001100134=Y\u000110104=Y\u000112052=3\u00018013=R\u00016=2500.0\u000110292=924\u000111041=17\u000110514=LQUK\u000110515=148\u00011133=D\u000111040=102\u000111210=12164050JFDo\u000110438=RIO.4.5\u000110533=1\u000110534=CGM\u000110535=5\u000110537=CGME\u0001100183=8001=CLIENT3:8015=CLIENT3:10005=6:8012=20120612\u00018012=20120612\u000110217=Y\u000110007=20120612-14:51:48.321\u000110000=20120612-14:51:47.973\u000110=000\u0001";
    		String msg3 = "8=FIX.4.4\u00019=1234\u000135=RIO\u000149=AEE\u000156=RIO\u000150=AEE1\u000157=C4_UK_DEV_T3\u000152=20120612-14:51:47.975\u0001122=20120612-14:51:47.973\u0001627=1\u0001628=UKLIQUIFI.OSM.1\u000110100=148674\u00011=TEST\u000154=2\u0001372=8\u00018001=CLIENT3\u00018004=SSG_IT2\u0001581=13\u000110018=12164050GbJK\u0001382=1\u0001375=LQUK\u000110053=LQPING\u000111=2757/2012-06-12-03:51\u0001150=F\u000110200=2757/2012-06-12-03:51UKLIQUIFI\u000110201=C4_LQPING\u000110202=EMEALP\u000110203=QFF\u000110204=LIQ\u000110206=2757/2012-06-12-03:51UKLIQUIFI\u000110207=UKLIQUIFI\u000110208=EMEA.LIQ\u0001548=P17623323028655001\u000114=1.0\u000110025=0\u000115=GBX\u0001-1=2757/2012-06-12-03:51\u0001100=LIQ\u000139=2\u000148=8113675\u0001167=CS\u000110076=CI\u000117=12164050GbJK\u000118=1\u000110017=LQUK\u000110021=AEE\u0001126=20120612-14:51:57.000\u000129=4\u0001-17=CLIENT3\u000110066=20120612-14:51:47.975\u000130=LQFI\u000131=2500.0\u000132=1.0\u0001151=0.0\u000140=1\u0001528=A\u000137=33364050JFDo\u000138=1.0\u000111015=20120612-14:51:47.972\u0001113=Y\u000122=101\u000110005=148\u000155=AZN.L\u0001-14=0\u000159=3\u000175=20120612\u000110039=sbxgran\u0001132=2500.0\u0001133=3100.0\u0001134=1000.0\u0001135=1000.0\u000160=20120612-14:51:47.975\u000110083=CLIENT3\u0001660=102\u0001847=1038\u000110071=20120612-14:51:47.985\u0001100134=Y\u000110104=Y\u000112052=3\u00018013=R\u00016=2500.0\u000110292=924\u000111041=17\u000110514=LQUK\u000110515=148\u00011133=D\u000111040=102\u000111210=12164050JFDo\u000110438=RIO.4.5\u000110533=1\u000110534=CGM\u000110535=5\u000110537=CGME\u0001100183=8001=CLIENT3:8015=CLIENT3:10005=6:8012=20120612\u00018012=20120612\u000110217=Y\u000110007=20120612-14:51:48.321\u000110000=20120612-14:51:47.973\u000110=000\u0001";

    		TextMessage message1 = session.createTextMessage(msg1);
    		TextMessage message2 = session.createTextMessage(msg2);
    		TextMessage message3 = session.createTextMessage(msg3);
            for(int i=0;i<200;i++){
            	producer.send(message1);
            	producer.send(message2);
            	producer.send(message3);
            }
            
       		String msg4 = "8=FIX.4.4\u00019=1234\u000135=RIO\u000149=AEE\u000156=RIO\u000150=AEE1\u000157=C4_UK_DEV_T3\u000152=20120612-14:51:47.975\u0001122=20120612-14:51:47.973\u0001627=1\u0001628=UKLIQUIFI.OSM.1\u000110100=148674\u00011=TEST\u000154=2\u0001372=8\u00018001=CLIENT3\u00018004=SSG_IT2\u0001581=13\u000110018=12164050GbJK\u0001382=1\u0001375=LQUK\u000110053=LQPING\u000111=2757/2012-06-12-03:51\u0001150=F\u000110200=2757/2012-06-12-03:51UKLIQUIFI\u000110201=C4_LQPING\u000110202=EMEALP\u000110203=QFF\u000110204=LIQ\u000110206=2757/2012-06-12-03:51UKLIQUIFI\u000110207=UKLIQUIFI\u000110208=EMEA.LIQ\u0001548=P17623323028655001\u000114=1.0\u000110025=0\u000115=GBX\u0001-1=2757/2012-06-12-03:51\u0001100=LIQ\u000139=2\u000148=8113675\u0001167=CS\u000110076=CI\u000117=12164050GbJK\u000118=1\u000110017=LQUK\u000110021=AEE\u0001126=20120612-14:51:57.000\u000129=4\u0001-17=CLIENT3\u000110066=20120612-14:51:47.975\u000130=LQFI\u000131=2500.0\u000132=1.0\u0001151=0.0\u000140=1\u0001528=A\u000137=44464050JFDo\u000138=1.0\u000111015=20120612-14:51:47.972\u0001113=Y\u000122=101\u000110005=148\u000155=AZN.L\u0001-14=0\u000159=3\u000175=20120612\u000110039=sbxgran\u0001132=2500.0\u0001133=3100.0\u0001134=1000.0\u0001135=1000.0\u000160=20120612-14:51:47.975\u000110083=CLIENT3\u0001660=102\u0001847=1038\u000110071=20120612-14:51:47.985\u0001100134=Y\u000110104=Y\u000112052=3\u00018013=R\u00016=2500.0\u000110292=924\u000111041=17\u000110514=LQUK\u000110515=148\u00011133=D\u000111040=102\u000111210=12164050JFDo\u000110438=RIO.4.5\u000110533=1\u000110534=CGM\u000110535=5\u000110537=CGME\u0001100183=8001=CLIENT3:8015=CLIENT3:10005=6:8012=20120612\u00018012=20120612\u000110217=Y\u000110007=20120612-14:51:48.321\u000110000=20120612-14:51:47.973\u000110=000\u0001";
    		String msg5 = "8=FIX.4.4\u00019=1234\u000135=RIO\u000149=AEE\u000156=RIO\u000150=AEE1\u000157=C4_UK_DEV_T3\u000152=20120612-14:51:47.975\u0001122=20120612-14:51:47.973\u0001627=1\u0001628=UKLIQUIFI.OSM.1\u000110100=148674\u00011=TEST\u000154=2\u0001372=8\u00018001=CLIENT3\u00018004=SSG_IT2\u0001581=13\u000110018=12164050GbJK\u0001382=1\u0001375=LQUK\u000110053=LQPING\u000111=2757/2012-06-12-03:51\u0001150=F\u000110200=2757/2012-06-12-03:51UKLIQUIFI\u000110201=C4_LQPING\u000110202=EMEALP\u000110203=QFF\u000110204=LIQ\u000110206=2757/2012-06-12-03:51UKLIQUIFI\u000110207=UKLIQUIFI\u000110208=EMEA.LIQ\u0001548=P17623323028655001\u000114=1.0\u000110025=0\u000115=GBX\u0001-1=2757/2012-06-12-03:51\u0001100=LIQ\u000139=2\u000148=8113675\u0001167=CS\u000110076=CI\u000117=12164050GbJK\u000118=1\u000110017=LQUK\u000110021=AEE\u0001126=20120612-14:51:57.000\u000129=4\u0001-17=CLIENT3\u000110066=20120612-14:51:47.975\u000130=LQFI\u000131=2500.0\u000132=1.0\u0001151=0.0\u000140=1\u0001528=A\u000137=55564050JFDo\u000138=1.0\u000111015=20120612-14:51:47.972\u0001113=Y\u000122=101\u000110005=148\u000155=AZN.L\u0001-14=0\u000159=3\u000175=20120612\u000110039=sbxgran\u0001132=2500.0\u0001133=3100.0\u0001134=1000.0\u0001135=1000.0\u000160=20120612-14:51:47.975\u000110083=CLIENT3\u0001660=102\u0001847=1038\u000110071=20120612-14:51:47.985\u0001100134=Y\u000110104=Y\u000112052=3\u00018013=R\u00016=2500.0\u000110292=924\u000111041=17\u000110514=LQUK\u000110515=148\u00011133=D\u000111040=102\u000111210=12164050JFDo\u000110438=RIO.4.5\u000110533=1\u000110534=CGM\u000110535=5\u000110537=CGME\u0001100183=8001=CLIENT3:8015=CLIENT3:10005=6:8012=20120612\u00018012=20120612\u000110217=Y\u000110007=20120612-14:51:48.321\u000110000=20120612-14:51:47.973\u000110=000\u0001";
    		String msg6 = "8=FIX.4.4\u00019=1234\u000135=RIO\u000149=AEE\u000156=RIO\u000150=AEE1\u000157=C4_UK_DEV_T3\u000152=20120612-14:51:47.975\u0001122=20120612-14:51:47.973\u0001627=1\u0001628=UKLIQUIFI.OSM.1\u000110100=148674\u00011=TEST\u000154=2\u0001372=8\u00018001=CLIENT3\u00018004=SSG_IT2\u0001581=13\u000110018=12164050GbJK\u0001382=1\u0001375=LQUK\u000110053=LQPING\u000111=2757/2012-06-12-03:51\u0001150=F\u000110200=2757/2012-06-12-03:51UKLIQUIFI\u000110201=C4_LQPING\u000110202=EMEALP\u000110203=QFF\u000110204=LIQ\u000110206=2757/2012-06-12-03:51UKLIQUIFI\u000110207=UKLIQUIFI\u000110208=EMEA.LIQ\u0001548=P17623323028655001\u000114=1.0\u000110025=0\u000115=GBX\u0001-1=2757/2012-06-12-03:51\u0001100=LIQ\u000139=2\u000148=8113675\u0001167=CS\u000110076=CI\u000117=12164050GbJK\u000118=1\u000110017=LQUK\u000110021=AEE\u0001126=20120612-14:51:57.000\u000129=4\u0001-17=CLIENT3\u000110066=20120612-14:51:47.975\u000130=LQFI\u000131=2500.0\u000132=1.0\u0001151=0.0\u000140=1\u0001528=A\u000137=66664050JFDo\u000138=1.0\u000111015=20120612-14:51:47.972\u0001113=Y\u000122=101\u000110005=148\u000155=AZN.L\u0001-14=0\u000159=3\u000175=20120612\u000110039=sbxgran\u0001132=2500.0\u0001133=3100.0\u0001134=1000.0\u0001135=1000.0\u000160=20120612-14:51:47.975\u000110083=CLIENT3\u0001660=102\u0001847=1038\u000110071=20120612-14:51:47.985\u0001100134=Y\u000110104=Y\u000112052=3\u00018013=R\u00016=2500.0\u000110292=924\u000111041=17\u000110514=LQUK\u000110515=148\u00011133=D\u000111040=102\u000111210=12164050JFDo\u000110438=RIO.4.5\u000110533=1\u000110534=CGM\u000110535=5\u000110537=CGME\u0001100183=8001=CLIENT3:8015=CLIENT3:10005=6:8012=20120612\u00018012=20120612\u000110217=Y\u000110007=20120612-14:51:48.321\u000110000=20120612-14:51:47.973\u000110=000\u0001";
    		
    		TextMessage message4 = session.createTextMessage(msg4);
    		TextMessage message5 = session.createTextMessage(msg5);
    		TextMessage message6 = session.createTextMessage(msg6);
    		
            for(int i=0;i<15;i++){
            	producer.send(message1);
            	producer.send(message4);
            	producer.send(message2);
            	producer.send(message5);
            	producer.send(message3);
            	producer.send(message6);
            	
            	for(int j=0;j<6;j++){
                	producer.send(message1);
                	producer.send(message2);
                	producer.send(message3);            		
            	}
            	producer.send(message1);
            	producer.send(message2);
            	producer.send(message3);
            }

            
            session.close();

		} catch (Exception e) {
			System.out.println("Error creating JMS connection." + e.getMessage());
		}

	}


    public static <T> int listHashCode(List<T> alist) {
        if (alist == null) {
            return 1;
        } else {
            return Arrays.deepHashCode(alist.toArray());
        }
      }

}// end FixMsgSpout
